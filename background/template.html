<!DOCTYPE html>
<html>

<head>
    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }

        h2 {
            text-align: center;
        }
    </style>
    <script type='text/javascript'>
        var _data = '[%%dataValue%%]';
        var _dataKey = '[%%dataKey%%]';
        var _timeValue = '[%%timeValue%%]';
        var _date = '[%%currentDate%%]';
        var _time = '[%%currentTime%%]';
    </script>
</head>

<body>

    <h2>Google Meet Attence</h2>
    <h3 id="date"></h3>
    <h3 id="time"></h3>
    <table id="table">
        <tr id="headings">
            <th>ID</th>
            <th>Name</th>
        </tr>
    </table>

    <h3 style="background-color: red;">Work is in pending</h3>

    <script>
        date = document.getElementById("date").innerText = "Date:" + _date;
        time = document.getElementById("time").innerText = "Time:" + _time;
        var headings = document.getElementById("headings");
        var table = document.getElementById("table");


        var data = JSON.parse(_data);
        var key = JSON.parse(_dataKey);
        var timeValues = JSON.parse(_timeValue);

        // Time Value Update
        for (let el of timeValues) {
            headings.innerHTML += '<th>' + el + '</th>\n';
        }

        // Data Value Update
        for (let el of key) {
            console.log(data[el].name);
            let id = '<td>' + data[el].id + '</td>';
            let name = '<td>' + data[el].name + '</td>';
            let t = data[el].timeStamp;
            let tdata = "";
            for (let i of t) {
                tdata += '<td>' + i + '</td>';
            }
            table.innerHTML += '<tr>' + id + name + tdata + '</tr>';
        }
    </script>

</body>

</html>